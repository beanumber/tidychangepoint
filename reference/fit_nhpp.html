<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Fit a non-homogeneous Poisson process model to the exceedances of a time series. — fit_nhpp_region • tidychangepoint</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Fit a non-homogeneous Poisson process model to the exceedances of a time series. — fit_nhpp_region"><meta name="description" content="Any times series can be modeled as a non-homogeneous Poisson process of the
locations of the exceedances of the mean of the series. This function
uses the BMDL() criteria to determine the best fit parameters for each
region defined by the changepoint set returned by changepoints()."><meta property="og:description" content="Any times series can be modeled as a non-homogeneous Poisson process of the
locations of the exceedances of the mean of the series. This function
uses the BMDL() criteria to determine the best fit parameters for each
region defined by the changepoint set returned by changepoints()."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">tidychangepoint</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/tidychangepoint.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/climate_data.html">Climate data in tidychangepoint</a></li>
    <li><a class="dropdown-item" href="../articles/coen.html">Using Coen's algorithm</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Fit a non-homogeneous Poisson process model to the exceedances of a time series.</h1>

      <div class="d-none name"><code>fit_nhpp.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Any times series can be modeled as a non-homogeneous Poisson process of the
locations of the exceedances of the mean of the series. This function
uses the <code><a href="BMDL.html">BMDL()</a></code> criteria to determine the best fit parameters for each
region defined by the changepoint set returned by <code><a href="changepoints.html">changepoints()</a></code>.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">fit_nhpp_region</span><span class="op">(</span><span class="va">exc</span>, <span class="va">tau_left</span>, <span class="va">tau_right</span>, params <span class="op">=</span> <span class="fu"><a href="iweibull.html">parameters_weibull</a></span><span class="op">(</span><span class="op">)</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">fit_nhpp</span><span class="op">(</span><span class="va">x</span>, <span class="va">tau</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'nhpp'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/logLik.html" class="external-link">logLik</a></span><span class="op">(</span><span class="va">object</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'nhpp'</span></span>
<span><span class="fu"><a href="https://generics.r-lib.org/reference/glance.html" class="external-link">glance</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">mcdf</span><span class="op">(</span><span class="va">x</span>, dist <span class="op">=</span> <span class="st">"weibull"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">plot_intensity</span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-exc">exc<a class="anchor" aria-label="anchor" href="#arg-exc"></a></dt>
<dd><p>Output from <code><a href="exceedances.html">exceedances()</a></code></p></dd>


<dt id="arg-tau-left">tau_left<a class="anchor" aria-label="anchor" href="#arg-tau-left"></a></dt>
<dd><p>left-most changepoint</p></dd>


<dt id="arg-tau-right">tau_right<a class="anchor" aria-label="anchor" href="#arg-tau-right"></a></dt>
<dd><p>right-most changepoint</p></dd>


<dt id="arg-params">params<a class="anchor" aria-label="anchor" href="#arg-params"></a></dt>
<dd><p>Output from <code><a href="iweibull.html">parameters_weibull()</a></code></p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>arguments passed to <code><a href="https://rdrr.io/r/stats/optim.html" class="external-link">stats::optim()</a></code></p></dd>


<dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>An <code>nhpp</code> object</p></dd>


<dt id="arg-tau">tau<a class="anchor" aria-label="anchor" href="#arg-tau"></a></dt>
<dd><p>A vector of changepoints.</p></dd>


<dt id="arg-object">object<a class="anchor" aria-label="anchor" href="#arg-object"></a></dt>
<dd><p>An <code>nhpp</code> object</p></dd>


<dt id="arg-dist">dist<a class="anchor" aria-label="anchor" href="#arg-dist"></a></dt>
<dd><p>Name of the distribution</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A <code>tbl_df</code> with each row representing one region.</p>
<p>a numeric vector of length equal to the <a href="exceedances.html">exceedances</a> of <code>x</code></p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>Other model-fitting:
<code><a href="fit_lmshift.html">fit_lmshift</a>()</code>,
<code><a href="fit_meanshift.html">fit_meanshift</a>()</code>,
<code><a href="fit_meanvar.html">fit_meanvar</a>()</code>,
<code><a href="new_fun_cpt.html">new_fun_cpt</a>()</code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu">fit_nhpp_region</span><span class="op">(</span><span class="fu"><a href="exceedances.html">exceedances</a></span><span class="op">(</span><span class="va">DataCPSim</span><span class="op">)</span>, <span class="fl">0</span>, <span class="fl">575</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $par</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1]  10.0000 311.8929</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] -545.8334</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $counts</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> function gradient </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       43       43 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $convergence</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $message</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "CONVERGENCE: REL_REDUCTION_OF_F &lt;= FACTR*EPSMCH"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $logLik</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 1488.061</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="fu">fit_nhpp</span><span class="op">(</span><span class="va">DataCPSim</span>, tau <span class="op">=</span> <span class="fl">826</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> List of 6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ data         : Time-Series [1:1096] from 1 to 1096: 35.5 29 35.6 33 29.5 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ tau          : num 826</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ region_params: tibble [2 × 5] (S3: tbl_df/tbl/data.frame)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ region     : chr [1:2] "[0,826)" "[826,1.1e+03]"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ param_alpha: num [1:2] 0.949 0.78</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ param_beta : num [1:2] 5.055 0.116</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ logPost    : num [1:2] -353 -271</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ logLik     : num [1:2] -337 -270</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ model_params : Named num 63.2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..- attr(*, "names")= chr "threshold"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ fitted_values: Named num [1:1096] 43.2 43.2 43.2 43.2 43.2 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..- attr(*, "names")= chr [1:1096] "[0,826)" "[0,826)" "[0,826)" "[0,826)" ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ model_name   : chr "nhpp"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - attr(*, "class")= chr [1:2] "nhpp" "mod_cpt"</span>
<span class="r-in"><span><span class="fu">fit_nhpp</span><span class="op">(</span><span class="va">DataCPSim</span>, tau <span class="op">=</span> <span class="fl">826</span>, threshold <span class="op">=</span> <span class="fl">20</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> List of 6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ data         : Time-Series [1:1096] from 1 to 1096: 35.5 29 35.6 33 29.5 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ tau          : num 826</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ region_params: tibble [2 × 5] (S3: tbl_df/tbl/data.frame)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ region     : chr [1:2] "[0,826)" "[826,1.1e+03]"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ param_alpha: num [1:2] 0.983 0.764</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ param_beta : num [1:2] 0.9202 0.0841</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ logPost    : num [1:2] -830 -272</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ logLik     : num [1:2] -826 -270</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ model_params : Named num 20</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..- attr(*, "names")= chr "threshold"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ fitted_values: Named num [1:1096] 43.2 43.2 43.2 43.2 43.2 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..- attr(*, "names")= chr [1:1096] "[0,826)" "[0,826)" "[0,826)" "[0,826)" ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ model_name   : chr "nhpp"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - attr(*, "class")= chr [1:2] "nhpp" "mod_cpt"</span>
<span class="r-in"><span><span class="fu">fit_nhpp</span><span class="op">(</span><span class="va">DataCPSim</span>, tau <span class="op">=</span> <span class="fl">826</span>, threshold <span class="op">=</span> <span class="fl">200</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> List of 6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ data         : Time-Series [1:1096] from 1 to 1096: 35.5 29 35.6 33 29.5 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ tau          : num 826</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ region_params: tibble [2 × 5] (S3: tbl_df/tbl/data.frame)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ region     : chr [1:2] "[0,826)" "[826,1.1e+03]"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ param_alpha: num [1:2] 0.0605 0.5417</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ param_beta : num [1:2] 0.101 0.106</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ logPost    : num [1:2] -5.35 -77.25</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ logLik     : num [1:2] -1.72 -75.33</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ model_params : Named num 200</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..- attr(*, "names")= chr "threshold"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ fitted_values: Named num [1:1096] 43.2 43.2 43.2 43.2 43.2 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..- attr(*, "names")= chr [1:1096] "[0,826)" "[0,826)" "[0,826)" "[0,826)" ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ model_name   : chr "nhpp"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - attr(*, "class")= chr [1:2] "nhpp" "mod_cpt"</span>
<span class="r-in"><span><span class="fu">fit_nhpp</span><span class="op">(</span><span class="va">DataCPSim</span>, tau <span class="op">=</span> <span class="fu"><a href="changepoints.html">changepoints</a></span><span class="op">(</span><span class="fu"><a href="segment.html">segment</a></span><span class="op">(</span><span class="va">DataCPSim</span>, method <span class="op">=</span> <span class="st">"pelt"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> List of 6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ data         : Time-Series [1:1096] from 1 to 1096: 35.5 29 35.6 33 29.5 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ tau          : int [1:3] 547 822 972</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ region_params: tibble [4 × 5] (S3: tbl_df/tbl/data.frame)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ region     : chr [1:4] "[0,547)" "[547,822)" "[822,972)" "[972,1.1e+03]"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ param_alpha: num [1:4] 0.362 0.657 0.738 0.758</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ param_beta : num [1:4] 0.3922 0.0883 0.073 0.0749</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ logPost    : num [1:4] -60.1 -197.9 -150.2 -125.8</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ logLik     : num [1:4] -57.4 -196.1 -148.4 -124</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ model_params : Named num 63.2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..- attr(*, "names")= chr "threshold"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ fitted_values: Named num [1:1096] 35.3 35.3 35.3 35.3 35.3 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..- attr(*, "names")= chr [1:1096] "[0,547)" "[0,547)" "[0,547)" "[0,547)" ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ model_name   : chr "nhpp"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - attr(*, "class")= chr [1:2] "nhpp" "mod_cpt"</span>
<span class="r-in"><span><span class="va">nhpp</span> <span class="op">&lt;-</span> <span class="fu">fit_nhpp</span><span class="op">(</span><span class="va">DataCPSim</span>, tau <span class="op">=</span> <span class="fl">826</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">mcdf</span><span class="op">(</span><span class="va">nhpp</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [1]   3.686770   8.959924  10.453459  36.009425  36.781826  37.861718</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [7]  43.696179  49.336684  56.301163  65.465988  76.343633  85.221032</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [13]  85.958484  86.400791  86.548199  87.137697  87.285038  87.874266</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [19]  88.610501  89.199250  90.081980  90.376119  91.258226  91.405198</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [25]  92.286767  92.580522  93.461485  93.608268  94.195277  94.782087</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [31]  94.928759  95.075419  95.515324  95.661935  95.955120  96.248256</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [37]  96.980886  97.127376  97.713217  97.859647  99.030665  99.469603</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [43]  99.615892  99.762170 100.054690 100.785790 100.931975 101.078149</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [49] 101.224311 101.516602 102.101046 102.539261 102.831347 103.269393</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [55] 103.415386 104.145184 104.291110 104.582929 104.728822 105.603950</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [61] 105.749767 106.624437 107.061626 107.207335 108.081360 108.226993</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [67] 108.372616 108.663831 109.100573 109.391681 109.828266 109.973773</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [73] 110.264757 110.701154 111.137458 111.428275 111.573669 111.719052</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [79] 112.300483 113.027042 113.462856 114.189011 114.479403 114.624585</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [85] 115.205210 115.495463 116.365985 116.656081 116.946138 117.381150</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [91] 117.816074 118.250912 118.685663 119.120328 119.699748 119.844579</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [97] 120.568594 120.713368 120.858133 121.147635 121.726527 122.449933</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [103] 123.317714 123.462312 123.896052 124.474243 125.196777 125.341257</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [109] 125.485728 125.630189 125.774642 127.688330 129.601003 130.556960</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [115] 131.512664 132.468117 133.423317 135.332965 136.287412 137.241609</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [121] 138.195557 139.149254 140.102703 141.055902 142.008853 142.961556</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [127] 143.914012 144.866219 146.769894 147.721362 148.672583 149.623559</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [133] 150.574290 151.524776 152.475017 154.374767 155.324276 156.273542</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [139] 157.222566 158.171347 159.119885 160.068182 161.016238 161.964052</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [145] 162.911626 163.858959 164.806051 165.752905 167.645893 168.592029</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [151] 169.537926 172.374190 173.319137 174.263847 175.208321 176.152559</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [157] 177.096560 178.040326 178.983858 179.927154 180.870216 181.813043</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [163] 182.755637 183.697997 184.640124 185.582018 186.523680 187.465109</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [169] 188.406306 189.347272 190.288007 191.228510 192.168783 193.108825</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [175] 194.048638 194.988220 195.927574 196.866698 198.744260 199.682699</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [181] 200.620910 202.496649 203.434178 205.308556 206.245406 207.182030</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [187] 209.054603 209.990552 210.926276 212.797052 213.732105 214.666934</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [193] 215.601540 217.470085 218.404023 220.271235 222.137563 223.070395</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [199] 224.003007 224.935398 225.867570 226.799523 227.731256 228.662770</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [205] 229.594066 230.525143 231.456002 232.386643 233.317066 234.247272</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [211] 236.107034 237.036590 237.965930 238.895054 239.823963 240.752656</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [217] 241.681134 242.609398 243.537447 245.392902 246.320309 247.247503</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [223] 249.101251 250.954149 251.880280 252.806199 253.731906 254.657403</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [229] 255.582688 257.432627 258.357281 259.281725 260.205960 261.129985</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [235] 262.053801 262.977408 263.900807 264.823997 265.746979 266.669754</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [241] 267.592321 268.514680 269.436833 270.358779 271.280518 272.202051</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [247] 273.123378 274.044500 274.965416 275.886126 276.806632 277.726933</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [253] 278.647029 279.566922 280.486610 281.406095 282.325376 283.244454</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [259] 284.163328 285.082001 286.000470 286.918738 287.836804 288.754667</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [265] 289.672330 290.589791 291.507051 292.424110 293.340969 294.257628</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [271] 295.174086 296.090345 297.006404 297.922264 298.837925 299.753387</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [277] 300.668651 301.583716 302.498583 303.413253 304.327724 305.241999</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [283] 306.156076 307.069956 307.983639 308.897127 309.810417 310.723512</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [289] 311.636412 312.549115 313.461624 314.373937 315.286056 316.197980</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [295] 317.109709 318.021245 318.932586 319.843734 320.754689 321.665450</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [301] 322.576019 323.486394 324.396577 325.306568 326.216367 327.125974</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [307] 328.035389 328.944613 329.853645 330.762487 331.671138 332.579599</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [313] 333.487869 334.395949 335.303839 336.211540 337.119051 338.026373</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [319] 338.933506 339.840451 340.747207 341.653774 342.560154 343.466345</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [325] 344.372349 345.278166 346.183795 347.089237 347.994492 348.899561</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [331] 349.804444 350.709140 351.613650 352.517975 353.422114 354.326068</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [337] 355.229837 356.133420 357.036819 357.940034 358.843064 359.745911</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [343] 360.648573 361.551052 362.453347 363.355460 364.257389 365.159135</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [349] 366.060699 366.962080 367.863279 368.764296 369.665132 370.565786</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [355] 371.466258 372.366549 373.266659 374.166589 375.066338 375.965906</span>
<span class="r-in"><span><span class="va">nhpp</span> <span class="op">&lt;-</span> <span class="fu">fit_nhpp</span><span class="op">(</span><span class="va">DataCPSim</span>, tau <span class="op">=</span> <span class="fl">826</span>, threshold <span class="op">=</span> <span class="fl">200</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">mcdf</span><span class="op">(</span><span class="va">nhpp</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1] 12.04806 13.61487 14.31512 14.78032 15.55279 15.62984 15.93769 16.24498</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [9] 17.08715 18.15300 18.22888 18.68344 18.83469 19.43837 19.88975 20.11500</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [17] 20.56462 20.71423 21.01308 22.27750 22.42565</span>
<span class="r-in"><span><span class="fu">plot_intensity</span><span class="op">(</span><span class="fu">fit_nhpp</span><span class="op">(</span><span class="va">DataCPSim</span>, tau <span class="op">=</span> <span class="fl">826</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="fit_nhpp-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="va">mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="segment.html">segment</a></span><span class="op">(</span><span class="va">bogota_pm</span>, method <span class="op">=</span> <span class="st">"pelt"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">plot_intensity</span><span class="op">(</span><span class="fu">fit_nhpp</span><span class="op">(</span><span class="va">bogota_pm</span>, tau <span class="op">=</span> <span class="fu"><a href="changepoints.html">changepoints</a></span><span class="op">(</span><span class="va">mod</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="fit_nhpp-2.png" alt="" width="700" height="433"></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Benjamin S. Baumer, Biviana Marcela Suarez Sierra, Arrigo Coen, Carlos A. Taimal.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer></div>





  </body></html>

