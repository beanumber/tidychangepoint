<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>tidychangepoint • tidychangepoint</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="tidychangepoint">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">tidychangepoint</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.1.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item"><a class="nav-link" href="../articles/tidychangepoint.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/climate_data.html">Climate data in tidychangepoint</a></li>
    <li><a class="dropdown-item" href="../articles/coen.html">Using Coen's algorithm</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>tidychangepoint</h1>
            
      

      <div class="d-none name"><code>tidychangepoint.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="tidy-methods-for-changepoint-analysis">Tidy methods for changepoint analysis<a class="anchor" aria-label="anchor" href="#tidy-methods-for-changepoint-analysis"></a>
</h2>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://beanumber.github.io/tidychangepoint/">tidychangepoint</a></span><span class="op">)</span></span></code></pre></div>
<p>The <code>tidychangepoint</code> package allows you to use any number
of algorithms for detecting changepoint sets in univariate time series
with a common, <code>tidyverse</code>-compliant interface. It also
provides model-fitting procedures for commonly-used parametric models,
tools for computing various penalty functions, and graphical diagnostic
displays.</p>
<p>Changepoint sets are computed using the <code><a href="../reference/segment.html">segment()</a></code>
function, which takes a numeric vector that is coercible into a
<code>ts</code> object, and a string indicating the algorithm you wish
you use. <code><a href="../reference/segment.html">segment()</a></code> always returns a <code>tidycpt</code>
object.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/segment.html">segment</a></span><span class="op">(</span><span class="va">DataCPSim</span>, method <span class="op">=</span> <span class="st">"pelt"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "tidycpt"</span></span></code></pre></div>
<p>Various methods are available for <code>tidycpt</code> objects. For
example, <code><a href="https://rdrr.io/r/stats/ts.html" class="external-link">as.ts()</a></code> returns the original data as
<code>ts</code> object, and <code><a href="../reference/changepoints.html">changepoints()</a></code> returns the set
of changepoint indices.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/changepoints.html">changepoints</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 547 822 972</span></span></code></pre></div>
<div class="section level3">
<h3 id="retrieving-information-using-the-broom-interface">Retrieving information using the <code>broom</code> interface<a class="anchor" aria-label="anchor" href="#retrieving-information-using-the-broom-interface"></a>
</h3>
<p><code>tidychangepoint</code> follows the design interface of the
<code>broom</code> package. Therefore, <code><a href="https://generics.r-lib.org/reference/augment.html" class="external-link">augment()</a></code>,
<code><a href="https://generics.r-lib.org/reference/tidy.html" class="external-link">tidy()</a></code> and <code><a href="https://generics.r-lib.org/reference/glance.html" class="external-link">glance()</a></code> methods exists for
<code>tidycpt</code> objects.</p>
<ul>
<li>
<code><a href="https://generics.r-lib.org/reference/augment.html" class="external-link">augment()</a></code> returns a <code>tsibble</code> that is
grouped according to the regions defined by the changepoint set.</li>
</ul>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://generics.r-lib.org/reference/augment.html" class="external-link">augment</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span><span class="co">#&gt; Registered S3 method overwritten by 'tsibble':</span></span>
<span><span class="co">#&gt;   method               from </span></span>
<span><span class="co">#&gt;   as_tibble.grouped_df dplyr</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tsibble: 1,096 x 5 [1]</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># Groups:    region [4]</span></span></span>
<span><span class="co">#&gt;    index     y region  .fitted  .resid</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>     1  35.5 [0,547)    35.3   0.232</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>     2  29.0 [0,547)    35.3  -<span style="color: #BB0000;">6.27</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>     3  35.6 [0,547)    35.3   0.357</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>     4  33.0 [0,547)    35.3  -<span style="color: #BB0000;">2.29</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>     5  29.5 [0,547)    35.3  -<span style="color: #BB0000;">5.74</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>     6  25.4 [0,547)    35.3  -<span style="color: #BB0000;">9.87</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>     7  28.8 [0,547)    35.3  -<span style="color: #BB0000;">6.45</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>     8  50.3 [0,547)    35.3  15.0  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>     9  24.9 [0,547)    35.3 -<span style="color: #BB0000;">10.3</span>  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span>    10  58.9 [0,547)    35.3  23.6  </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 1,086 more rows</span></span></span></code></pre></div>
<ul>
<li>
<code><a href="https://generics.r-lib.org/reference/tidy.html" class="external-link">tidy()</a></code> returns a <code>tbl</code> that provides summary
statistics for each region. These include any parameters that were fit,
which are prefixed in the output by <code>param_</code>.</li>
</ul>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html" class="external-link">tidy</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 4 × 10</span></span></span>
<span><span class="co">#&gt;   region  num_obs   min   max  mean    sd begin   end param_mu param_sigma_hatsq</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>             <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> [0,547)     546  13.7  92.8  35.3  11.3     0   547     35.3              127.</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> [547,8…     275  20.5 163.   58.1  19.3   547   822     58.1              372.</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> [822,9…     150  39.2 215.   96.7  30.5   822   972     96.7              924.</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> [972,1…     125  67.2 299.  156.   49.6   972  <span style="text-decoration: underline;">1</span>096    156.              <span style="text-decoration: underline;">2</span>442.</span></span></code></pre></div>
<ul>
<li>
<code><a href="https://generics.r-lib.org/reference/glance.html" class="external-link">glance()</a></code> returns a <code>tbl</code> that provides
summary statistics for the algorithm. This includes the
<code>fitness</code>, which is the value of the penalized objective
function that was used.</li>
</ul>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://generics.r-lib.org/reference/glance.html" class="external-link">glance</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 1 × 8</span></span></span>
<span><span class="co">#&gt;   pkg      version algorithm seg_params model_name criteria fitness elapsed_time</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;pckg_&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;drtn&gt;</span>      </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> changep… 2.3     PELT      <span style="color: #949494;">&lt;list [1]&gt;</span> meanvar    MBIC       <span style="text-decoration: underline;">9</span>403. 0.064 secs</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="other-methods">Other methods<a class="anchor" aria-label="anchor" href="#other-methods"></a>
</h3>
<p>The <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code> method leverages <code>ggplot2</code> to
provide an informative plot, with the regions defined by the changepoint
set clearly demarcated, and the means within each region also
indicated.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span></code></pre></div>
<p><img src="tidychangepoint_files/figure-html/pelt-plot-1.png" width="700"></p>
<p>Other generic functions defined for <code>tidycpt</code> objects
include <code><a href="../reference/fitness.html">fitness()</a></code>, <code><a href="../reference/as.model.html">as.model()</a></code>, and
<code><a href="../reference/exceedances.html">exceedances()</a></code>. For example, <code><a href="../reference/fitness.html">fitness()</a></code> returns
a named vector with the value of the penalized objective function
used.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/fitness.html">fitness</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span><span class="co">#&gt;     MBIC </span></span>
<span><span class="co">#&gt; 9403.391</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="structure">Structure<a class="anchor" aria-label="anchor" href="#structure"></a>
</h2>
<p>Every <code>tidycpt</code> objects contains two main children:</p>
<ul>
<li>
<code>segmenter</code>: The object that results from the changepoint
detection algorithm. These can be of any class. Methods for objects of
class <code>cpt</code>, <code>ga</code>, and <code>wbs</code> are
currently implemented, and as well as <code>seg_basket</code> (the
default internal class). Given a data set, a model, and a penalized
objective function, a segmenter’s job is to search the
exponentially-large space of possible changepoint sets for the one that
optimizes the penalized objective function (over the space of possible
changepoint sets). Some segmenting algorithms (e.g., PELT) are
deterministic, while others (e.g., genetic algorithms) are
randomized.</li>
<li>
<code>model</code>: A model object inheriting from
<code>mod_cpt</code>, an internal class for representing model objects.
Model objects are created by model-fitting functions, all of whose names
start with <code>fit_</code>. The <code>model</code> of a
<code>tidycpt</code> object is the model object returned by the
<code>fit_*()</code> function that corresponds to the one used by the
<code>segmenter</code>. Given a data set, a model description,
<strong>and a set of changepoints</strong>, the corresponding
model-fitting function finds the values of the model parameters that
optimize the model fit to the data.</li>
</ul>
<p>Both <strong>segmenters and models</strong> implement methods for the
generic functions <code><a href="../reference/changepoints.html">changepoints()</a></code>, <code><a href="https://rdrr.io/r/stats/ts.html" class="external-link">as.ts()</a></code>,
<code><a href="https://rdrr.io/r/stats/nobs.html" class="external-link">nobs()</a></code>, <code><a href="https://rdrr.io/r/stats/logLik.html" class="external-link">logLik()</a></code>, <code><a href="../reference/model_name.html">model_name()</a></code>,
and <code><a href="https://generics.r-lib.org/reference/glance.html" class="external-link">glance()</a></code>. However, it is important to note that while
<code>tidychangepoint</code> does its best to match the model used by
the <code>segmenter</code> to its corresponding model-fitting function,
exact matches do not always exist. Thus, the <code><a href="https://rdrr.io/r/stats/logLik.html" class="external-link">logLik()</a></code> of
the <code>segmenter</code> may not always match the
<code><a href="https://rdrr.io/r/stats/logLik.html" class="external-link">logLik()</a></code> of the <code>model</code>. Nevertheless, squaring
these values is the focus of ongoing work.</p>
<div class="section level3">
<h3 id="segmenters">Segmenters<a class="anchor" aria-label="anchor" href="#segmenters"></a>
</h3>
<p>In the example above, the <code>segmenter</code> is of class
<code>cpt</code>, because <code><a href="../reference/segment.html">segment()</a></code> simply wraps the
<code>cpt.meanvar()</code> function from the <code>changepoint</code>
package.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/as.segmenter.html">as.segmenter</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; Formal class 'cpt' [package "changepoint"] with 12 slots</span></span>
<span><span class="co">#&gt;   ..@ data.set : Time-Series [1:1096] from 1 to 1096: 35.5 29 35.6 33 29.5 ...</span></span>
<span><span class="co">#&gt;   ..@ cpttype  : chr "mean and variance"</span></span>
<span><span class="co">#&gt;   ..@ method   : chr "PELT"</span></span>
<span><span class="co">#&gt;   ..@ test.stat: chr "Normal"</span></span>
<span><span class="co">#&gt;   ..@ pen.type : chr "MBIC"</span></span>
<span><span class="co">#&gt;   ..@ pen.value: num 28</span></span>
<span><span class="co">#&gt;   ..@ minseglen: num 2</span></span>
<span><span class="co">#&gt;   ..@ cpts     : int [1:4] 547 822 972 1096</span></span>
<span><span class="co">#&gt;   ..@ ncpts.max: num Inf</span></span>
<span><span class="co">#&gt;   ..@ param.est:List of 2</span></span>
<span><span class="co">#&gt;   .. ..$ mean    : num [1:4] 35.3 58.2 96.8 156.5</span></span>
<span><span class="co">#&gt;   .. ..$ variance: num [1:4] 127 371 921 2406</span></span>
<span><span class="co">#&gt;   ..@ date     : chr "Fri Jan 10 14:47:09 2025"</span></span>
<span><span class="co">#&gt;   ..@ version  : chr "2.3"</span></span></code></pre></div>
<p>In addition to the generic functions listed above,
<strong>segmenters</strong> implement methods for the generic functions
<code><a href="../reference/fitness.html">fitness()</a></code>, <code><a href="../reference/model_args.html">model_args()</a></code>, and
<code><a href="../reference/seg_params.html">seg_params()</a></code>.</p>
</div>
<div class="section level3">
<h3 id="models">Models<a class="anchor" aria-label="anchor" href="#models"></a>
</h3>
<p>The <code>model</code> object in this case is created by
<code><a href="../reference/fit_meanvar.html">fit_meanvar()</a></code>, and is of class <code>mod_cpt</code>.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/as.model.html">as.model</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; List of 6</span></span>
<span><span class="co">#&gt;  $ data         : Time-Series [1:1096] from 1 to 1096: 35.5 29 35.6 33 29.5 ...</span></span>
<span><span class="co">#&gt;  $ tau          : int [1:3] 547 822 972</span></span>
<span><span class="co">#&gt;  $ region_params: tibble [4 × 3] (S3: tbl_df/tbl/data.frame)</span></span>
<span><span class="co">#&gt;   ..$ region           : chr [1:4] "[0,547)" "[547,822)" "[822,972)" "[972,1.1e+03]"</span></span>
<span><span class="co">#&gt;   ..$ param_mu         : num [1:4] 35.3 58.1 96.7 155.9</span></span>
<span><span class="co">#&gt;   ..$ param_sigma_hatsq: Named num [1:4] 127 372 924 2442</span></span>
<span><span class="co">#&gt;   .. ..- attr(*, "names")= chr [1:4] "[0,547)" "[547,822)" "[822,972)" "[972,1.1e+03]"</span></span>
<span><span class="co">#&gt;  $ model_params : NULL</span></span>
<span><span class="co">#&gt;  $ fitted_values: num [1:1096] 35.3 35.3 35.3 35.3 35.3 ...</span></span>
<span><span class="co">#&gt;  $ model_name   : chr "meanvar"</span></span>
<span><span class="co">#&gt;  - attr(*, "class")= chr "mod_cpt"</span></span></code></pre></div>
<p>In addition to the generic functions listed above,
<strong>models</strong> implement methods for the generic functions
<code><a href="https://rdrr.io/r/stats/fitted.values.html" class="external-link">fitted()</a></code>, <code><a href="https://rdrr.io/r/stats/residuals.html" class="external-link">residuals()</a></code>, <code><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef()</a></code>,
<code><a href="https://generics.r-lib.org/reference/augment.html" class="external-link">augment()</a></code>, <code><a href="https://generics.r-lib.org/reference/tidy.html" class="external-link">tidy()</a></code>, and
<code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code>.</p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Benjamin S. Baumer, Biviana Marcela Suárez Sierra, Arrigo Coen, Carlos A. Taimal.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
